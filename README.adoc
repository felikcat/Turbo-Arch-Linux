:experimental:
ifdef::env-github[]
:icons:
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]
:imagesdir: imgs/

.*Dux* is a pragmatic Arch Linux installer; the primary benefits:
- Has some desktop & gaming optimizations that ArchInstall and ArchTitus fail to do themselves, the ladder two being optimized for servers instead (Linux defaults).
- Kept simple and programmed in Bash.
** There's customizability, but only if important.
*** Chasing immense customizability will lead to many bugs, if you want that, use ArchInstall or Archboot instead.
** It's one way or the highway intentionally. If you don't like parts of Dux, you can change that after the fact, as a regular Arch Linux user would.
- No third-party repos that break the OS, unlike Manjaro.
- Tunnel-visioned on maintaining a stable OS, such as using Btrfs snapshots automatically.
- systemd services are avoided whenever possible, as they are lower-quality than alternatives.
- What's used is what is the most pragmatic, which is currently KDE. Historically there was a https://gist.github.com/felikcat/ae4d80bd6af49f336b0bbd3bb15bc469[GNOME installer].
- Uses tricks to speed up installation compared to alternatives, without causing issues.


== Requirements
. An Intel or AMD CPU newer than 2005.
. *1.5GB* of RAM; 4GB recommended.
. *16GB* of disk space; *128GB* recommended.
- If you have *16GB* of RAM, add on *16GB* more to this requirement, same applies to *32GB* of RAM for *32GB* of disk space.
. *UEFI* must be enabled.
** If booting into the Arch Linux ISO fails on UEFI, a very rare IA32 UEFI BIOS is used. Follow link:https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface#Booting_64-bit_kernel_on_32-bit_UEFI[these instructions] to successfully boot the Arch Linux ISO.
. link:https://archive.is/QwLMB[Disable UEFI Secure Boot]
** If convincing is needed, link:https://github.com/pbatard/rufus/wiki/FAQ#Why_do_I_need_to_disable_Secure_Boot_to_use_UEFINTFS[read this].

NOTE: Dual-booting is supported, given Windows is on a different disk (hard drive) than Arch Linux.



== 1. Verify ISO authenticity

.Download the latest link:https://archlinux.org/download/[Arch Linux ISO]; if you have no torrent client, use link:https://www.qbittorrent.org/download.php[qBittorrent].
- Keep that tab open.

=== macOS
. Install Homebrew from https://brew.sh/
. `brew install gnupg`
. Follow the Linux instructions below.

=== *Windows*
. Install https://gpg4win.org/thanks-for-download.html[GnuPG] using its latest simple installer: +
image:GPG/firefox_4EiWmbJfJo.png[480,360]
. Open a Terminal or PowerShell in the directory of `gpg.exe`: +
image:GPG/explorer_sIHtC1HEcI.png[480,360]
. Follow the Linux instructions below.

=== Linux
. NOTE: The full key (not short or long) is used to fully protect against collision attacks. +
`gpg --auto-key-locate clear,wkd -v --locate-external-key pierre@archlinux.org`

. Download the "ISO PGP signature" from https://archlinux.org/download/[here].

. `gpg --full-gen-key`
```
Please select what kind of key you want:
   (1) RSA and RSA
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
   (9) ECC (sign and encrypt) *default*
  (10) ECC (sign only)
  (14) Existing key from card
Your selection? ↵

Please select which elliptic curve you want:
   (1) Curve 25519 *default*
   (4) NIST P-384
   (6) Brainpool P-256
Your selection? ↵

Please specify how long the key should be valid.
         0 = key does not expire
      <n>  = key expires in n days
      <n>w = key expires in n weeks
      <n>m = key expires in n months
      <n>y = key expires in n years
Key is valid for? (0) ↵
Key does not expire at all
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: dux
Email address: dux@dux.com
Comment:
You selected this USER-ID:
    "dux <dux@dux.com>"

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
```

. After your new GPG key has been generated, show its full key; [ultimate] indicates that you trust this key ultimately (you created the key), which is the desired behavior. +
`gpg --list-secret-keys --keyid-format none`

. Sign Arch's GPG key with yours. +
`gpg --sign-key 3E80CA1A8B89F69CBA57D98A76A5EF9054449A5C`

. Verify if the ISO is authentic, and its file integrity doesn't fail (indicates a broken download). +
`gpg --verify /path/to/archkbd:[TAB].sig`

- image:GPG/WindowsTerminal_RNqnz5MWaf.png[480,360]


== 2. Format a USB with the Arch Linux ISO
WARNING: This will destroy all previous data on the targeted device!

=== Windows
. Download and install rufus-$version.exe +
https://github.com/pbatard/rufus/releases
. Add the Arch ISO then copy the following settings: +
image:rufus-4.2_NDydafPQE3.png[480,360]

. Click Start, then use "Write in ISO -> ESP mode".

=== macOS and Linux
Use https://github.com/balena-io/etcher/releases[balenaEtcher].

.dd method (not recommended)
[%collapsible]
====
. Thoroughly list disks and partitions; to see what disk/drive you are going to format. +
`$ lsblk -o PATH,MODEL,PARTLABEL,FSTYPE,FSVER,SIZE,FSUSE%,FSAVAIL,MOUNTPOINTS`

. Do not append numbers to the end of /dev/EXAMPLE +
`# dd if=/path/to/archkbd:[TAB] of=/dev/EXAMPLE bs=8M oflag=direct status=progress`
====

=== OpenBSD
. List all available disks: +
`$ dmesg|egrep '^([cswf]d). '` or `$ df -h`

. List the partitions of a disk, and show sizes in gigabytes (-p g): +
`# disklabel -p g EXAMPLE`

. Do not append numbers to the end of /dev/EXAMPLE: +
`# dd bs=4M if=/path/to/archkbd:[TAB] of=/dev/EXAMPLE conv=sync`


== 3. Starting the Dux installer

Once booted into the Arch Linux ISO, ensure an internet connection is established. +
`$ ping archlinux.org`

.No connection?
[%collapsible]
====

*For Wi-Fi:*

. Run `# rfkill unblock all`
. `# iwctl` -> `station wlan0 connect your_wifi_SSID` -> `exit`
. `# systemctl restart systemd-networkd`

TIP: If "wlan0" is not the correct interface, use iwctl's `station list` to see your wireless interface(s).

*https://wiki.archlinux.org/title/Mmcli[For mobile modems]*.

====


. `# pacman-key --init`

. `# pacman -Syy git`

. `# git clone --depth=1 -b r1 https://github.com/felikcat/dux`

. Open `~/dux/src/Configs/settings.sh` in your editor of choice, likely `vim` or `nano`
** Do not remove options in Dux's configs! Disable them.

. `# bash ~/dux/src/format_disk.sh`
** kbd:[Ctrl] + kbd:[C] to exit the disk formatter if you're not comfortable proceeding.

. `# bash ~/dux/src/install_dux.sh`
** If there's issues: run with `DEBUG=1` (put before `bash`) for more verbose logs.

___

.After the reboot:
* Connect to your Wi-Fi network again if needed.
* Open "Konsole".
. `$ bash ~/dux/src/05-booted.sh`
- During this script, your account password will be asked for.

. Configure `~/dux/configs/software_catalog.sh` with a text editor of your choice.
** After done configuring, run: +
`# sudo bash ~/dux/src/software_catalog.sh`

___
*If you have issues, please read => link:potential_fixes.adoc[potential_fixes.adoc]*

== How to help Dux out
- Star this respository so more people see it, or other forms of publicity like YouTube videos.
- Make an account on the Arch Linux user repository, and "Vote for this package" for the following:
. https://aur.archlinux.org/packages/refind-btrfs
. https://aur.archlinux.org/packages/btrfs-assistant
